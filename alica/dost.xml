<context>

    

    <input pattern="* (привет*|здравствуй*) *">
        <output if="full($UserName)">
            <item value="Привет, $UserName! Рада снова видеть тебя! Поищем, что бы поесть?"/>
			
			
        </output>
<sample>
        <item value="Да"/>
         <item value="Давай поищем"/>
    </sample>
        <context if="empty($UserName)" id="user">
            <output value="Привет! Меня зовут Эльза из Эль Патио! Как зовут тебя?"/>

            <input pattern="$Text">
                <var name="UserName" value="cap($Text)" scope="user"/>
                <output value="Отлично, $UserName! Теперь поищем, что бы поесть?"/>
				<sample>
        <item value="Да"/>
        <item value="Давай поищем"/>
    </sample>
               
            </input>
        </context>
    </input>

    <input pattern="* (Да*|Давай*|Конечно*|Очень голоден*) *">
		<output value="Отлично, Пицца, суши или Бургеры?."/>
		<sample>
	<item value="Пицца"/>
  <item value="Суши"/>
<item value="Бургеры"/> 
</sample>
    </input>

	<input pattern="Пицца">
               	
                <output value="Отлично, в Новокунецке есть несколько отличных пиццерий. Но давайте узнаем ваш район?"/>
     <sample>
	<item value="Центральный"/>
  <item value="Заводской"/>
<item value="Новоильинский"/>
<item value="Куйбышевский"/>
<item value="Орджоникидзевский"/> 
</sample>
            </input>

	<input pattern="Суши">
               	
                <output value="Отлично, в Новокунецке есть несколько отличных японских ресторанов и суши баров. Но давайте узнаем ваш район?"/>
     <sample>
	<item value="Центральный"/>
  <item value="Заводской"/>
<item value="Новоильинский"/>
<item value="Куйбышевский"/>
<item value="Орджоникидзевский"/> 
</sample>
            </input>
			



	<input pattern="[* (кто|что) так*] $Text">
        <context id="name" if="empty($UserName)"/>

        <context id="wiki" if="full($UserName)">
            <get url="http://ru.wikipedia.org/w/api.php" var="Wiki">
                <param name="format" value="xml"/>
                <param name="action" value="opensearch"/>
                <param name="search" value="$Text"/>
            </get>

            <var name="Items" value="javascript: $Wiki['SearchSuggestion']['Section']['Item']" if="full($Wiki)" scope="context"/>
            <var name="Result" value="javascript: $Items[Math.floor(Math.random() * $Items.length)]['Description']['content']" if="full($Items)"/>

            <output if="empty($Result)">
                <item value='Я поискала в википедии, но ничего не нашла по запросу "$Text"'/>
                <item value="В википедии ничего не нашлось..."/>
            </output>

            <output value="$Result" if="full($Result)"/>

            <input pattern="* (еще|другой вариант) *"/>

            <sample value="Другой вариант"/>
        </context>


    </input>

</context>
